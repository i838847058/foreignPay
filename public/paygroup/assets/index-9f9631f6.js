import{d as e,r as a,K as l,a as s,i as t,c as r,f as o,w as u,e as d,m as n,N as i,s as p,v as c,x as m,R as f,S as _,E as h,y as g,T as v,_ as b,o as w,U as V,B as y,F as C,aa as k,I as x,J as T,p as U,h as q,H as E,G as j}from"./index-2cb78bc5.js";import{E as D}from"./el-switch-3a8fdfd4.js";/* empty css                        */import{b as z,d as F,e as I,f as B}from"./index-d3e2ba33.js";import{E as M,a as R}from"./el-col-37336422.js";const O={class:"dialog-footer"},P=b(e({__name:"RegistrationDialog",setup(e,{expose:b}){const w=i("emitter"),V=a(!1),y=a();l(V,((e,a)=>{e&&(y.value={username:"",password:"",role:1})}));const C=s({username:[{required:!0,message:"请输入商户账号：",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(e,a,l)=>{a?/^.{6,}$/.test(a)?l():l(new Error("请输入密码，最少6位")):l(new Error("请输入密码"))},trigger:"blur"}]}),k=a();return b({dialogFormVisible:V}),(e,a)=>{const l=c,s=m,i=M,b=R,x=f,T=_,U=h,q=g,E=v;return t(),r("div",null,[o(E,{modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=e=>V.value=e),title:"添加账号",class:"sub-dialog",closeOnClickModal:!1,width:"756px","destroy-on-close":!0},{footer:u((()=>[d("span",O,[o(q,{type:"primary",onClick:a[3]||(a[3]=e=>(async e=>{e&&await e.validate(((e,a)=>{e&&z(y.value).then((e=>{1===e.code&&(p({title:"通知",message:"添加成功",type:"success",showClose:!1,duration:3e3}),V.value=!1,w.emit("refreshTable"))}))}))})(k.value))},{default:u((()=>[n("生成账号")])),_:1})])])),default:u((()=>[o(U,{model:y.value,ref_key:"ruleFormRef",ref:k,rules:C,"label-position":"top"},{default:u((()=>[o(b,{gutter:18},{default:u((()=>[o(i,{span:12},{default:u((()=>[o(s,{label:"商户账号：",prop:"username",required:""},{default:u((()=>[o(l,{modelValue:y.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value.username=e),size:"large",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(b,{gutter:18},{default:u((()=>[o(i,{span:12},{default:u((()=>[o(s,{label:"密码：",prop:"password",required:""},{default:u((()=>[o(l,{size:"large",modelValue:y.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>y.value.password=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(b,{gutter:18},{default:u((()=>[o(i,{span:12},{default:u((()=>[o(s,{label:"商户类型：",prop:"role",required:""},{default:u((()=>[o(T,{size:"large",placeholder:"请选择",modelValue:y.value.role,"onUpdate:modelValue":a[2]||(a[2]=e=>y.value.role=e)},{default:u((()=>[o(x,{label:"普通商户",value:1}),o(x,{label:"代理商",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-57e70580"]]),S={class:"search-data"},$=(e=>(U("data-v-3ccfa806"),e=e(),q(),e))((()=>d("div",{class:"search-result"},"商户信息",-1))),G=b(e({__name:"SearchTable",setup(e){const l=i("emitter"),c=s({data:{}}),m=a(),f=s({data:{}});w((()=>{_(),l.on("refreshTable",_)})),V((()=>{l.off("refreshTable")}));const _=(e=1,a=10)=>{F({page:e,rows:a}).then((e=>{c.data=e.data}))};return(e,a)=>{const l=x,s=D,i=g,h=T;return t(),r(C,null,[d("div",S,[$,o(h,{table:c.data,onCurrentChange:_},{default:u((()=>[o(l,{prop:"username",label:"商户账号"}),o(l,{prop:"nickname",label:"商户名称"}),o(l,{prop:"product_type_ids_text",label:"商户类型"},{default:u((e=>[n(y(1===e.row.role?"普通商户":"代理商"),1)])),_:1}),o(l,{prop:"status",label:"账号状态",width:"120"},{default:u((e=>[o(s,{modelValue:e.row.mch_status,"onUpdate:modelValue":a=>e.row.mch_status=a,"active-value":1,"inactive-value":0,onChange:a=>(({id:e,mch_status:a})=>{I({user_id:e,mch_status:a}).then((e=>{1===e.code&&p({title:"通知",message:"更改状态成功",type:"success",showClose:!1,duration:3e3})}))})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),o(l,{prop:"createtime",label:"创建时间","min-width":"160"}),o(l,{prop:"updatetime",label:"最新修改时间","min-width":"160"}),o(l,{fixed:"right",label:"操作",width:"150"},{default:u((e=>[o(i,{link:"",type:"primary",size:"small",onClick:a=>(({id:e})=>{k.prompt("请输入密码","修改密码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{6,}$/,inputErrorMessage:"密码不能少于6位",closeOnClickModal:!1}).then((({value:a})=>{B({user_id:e,password:a}).then((e=>{1===e.code&&p({title:"通知",message:"修改成功",type:"success",showClose:!1,duration:3e3})}))})).catch((()=>{}))})(e.row)},{default:u((()=>[n(" 修改密码 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["table"])]),o(P,{ref_key:"registrationDialog",ref:m,channelData:f},null,8,["channelData"])],64)}}}),[["__scopeId","data-v-3ccfa806"]]),H={class:"search-container"},J={class:"header"},K=b(e({__name:"index",setup(e){const l=a();return(e,a)=>{const s=E("Plus"),i=j,p=g;return t(),r(C,null,[d("div",H,[d("div",J,[o(p,{type:"primary",onClick:a[0]||(a[0]=e=>l.value.dialogFormVisible=!0)},{default:u((()=>[o(i,null,{default:u((()=>[o(s)])),_:1}),n(" 添加账号 ")])),_:1})]),o(G)]),o(P,{ref_key:"registrationDialog",ref:l},null,512)],64)}}}),[["__scopeId","data-v-0b04b2ba"]]);export{K as default};
