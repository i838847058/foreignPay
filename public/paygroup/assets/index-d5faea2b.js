import{d as e,z as a,r as l,a as t,K as u,i as r,c as d,f as n,w as i,e as o,L as s,m as p,F as _,M as c,j as m,l as g,N as v,O as b,P as f,Q as h,s as y,v as V,x as w,R as k,S as q,E as U,y as x,T as z,_ as C,o as D,U as E,V as j,B as F,W as T,I,J as R,p as $,h as L,H as M,G as O}from"./index-2cb78bc5.js";import{E as P}from"./el-switch-3a8fdfd4.js";/* empty css                        */import{_ as S,E as B,a as G}from"./index-bb039284.js";import{E as H,a as J}from"./el-col-37336422.js";const K={class:"dialog-footer"},N=C(e({__name:"ChannelEntryDialog",props:["channelData"],setup(e,{expose:C}){const D=e,E=v("emitter"),j=a(),F=["通道基本信息","支付产品信息","通道资金信息"],T=l(0),I=l(!1),R=l([]),$=l(),L=(e,a,l)=>{a?/^[0-9]+(\.[0-9]{1,2})?$/.test(a)?l():l(new Error("请输入数字，最多两位小数")):l(new Error("请输入保证金"))},M=t({channel_name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],channel_num:[{required:!0,message:"请输入通道号",trigger:"blur"}],country_ids:[{required:!0,type:"array",message:"请选择国家",trigger:"change"}],margin_balance:[{required:!0,message:"请输入保证金",trigger:"blur"},{validator:L,trigger:"blur"}],balance:[{required:!0,message:"请输入余额",trigger:"blur"},{validator:L,trigger:"blur"}],pay_way_id:[{required:!0,message:"请选择代收支付方式",trigger:"change"}],coin_ids:[{required:!0,type:"array",trigger:"change",message:"请选择代收货币"}],billing_id:[{required:!0,trigger:"change",message:"请选择结算周期"}],pay_rate:[{required:!0,message:"请输入通道费率：",trigger:"blur"},{validator:L,trigger:"blur"}],product_type_id:[{required:!0,trigger:"change",message:"请选择支持产品类型"}]}),O=l();u(I,((e,a)=>{e&&($.value={channel_name:"",channel_num:"",country_ids:[],product_type_id:"",coin_ids:[],pay_way_id:"",billing_id:[],is_u:1,margin_balance:null,balance:null,pay_rate:"",status:0},D.channelData&&(P(D.channelData.data.country_ids),$.value={...D.channelData.data})),T.value=0}));const P=e=>{b(e.join(",")).then((e=>{R.value=e.data||[]}))},N=async e=>{e&&await e.validate(((e,a)=>{if(e){if(T.value!==F.length-1)return void T.value++;D.channelData?f($.value).then((e=>{1===e.code&&Q("修改")})):h($.value).then((e=>{1===e.code&&Q("新增")}))}}))},Q=e=>{y({title:"通知",message:`${e}成功`,type:"success",showClose:!1,duration:3e3}),I.value=!1,E.emit("refreshTable")};return C({dialogFormVisible:I}),(e,a)=>{const l=S,t=V,u=w,v=H,b=J,f=k,h=q,y=U,C=B,E=G,L=x,Q=z;return r(),d("div",null,[n(Q,{modelValue:I.value,"onUpdate:modelValue":a[14]||(a[14]=e=>I.value=e),title:""+(D.channelData?"通道信息修改":"通道录入"),class:"sub-dialog",closeOnClickModal:!1,"destroy-on-close":!0,width:"756px"},{footer:i((()=>[o("span",K,[T.value!==F.length-1?(r(),s(L,{key:0,type:"primary",onClick:a[12]||(a[12]=e=>N(O.value))},{default:i((()=>[p("下一页")])),_:1})):(r(),s(L,{key:1,type:"primary",onClick:a[13]||(a[13]=e=>N(O.value))},{default:i((()=>[p("保存")])),_:1}))])])),default:i((()=>[n(l,{class:"steps",steps:F,active:T.value,"onUpdate:active":a[0]||(a[0]=e=>T.value=e)},null,8,["active"]),0===T.value?(r(),s(y,{key:0,model:$.value,ref_key:"ruleFormRef",ref:O,rules:M,"label-position":"top"},{default:i((()=>[n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"通道名称：",prop:"channel_name",required:""},{default:i((()=>[n(t,{modelValue:$.value.channel_name,"onUpdate:modelValue":a[1]||(a[1]=e=>$.value.channel_name=e),size:"large",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"通道编号：",prop:"channel_num",required:""},{default:i((()=>[n(t,{size:"large",modelValue:$.value.channel_num,"onUpdate:modelValue":a[2]||(a[2]=e=>$.value.channel_num=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"支持产品类型：",prop:"product_type_id",required:""},{default:i((()=>[n(h,{size:"large",placeholder:"请选择",modelValue:$.value.product_type_id,"onUpdate:modelValue":a[3]||(a[3]=e=>$.value.product_type_id=e)},{default:i((()=>[(r(!0),d(_,null,c(m(j).basicData.options.product_type,((e,a)=>(r(),s(f,{label:e.value,value:e.id,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])):1===T.value?(r(),s(y,{key:1,model:$.value,ref_key:"ruleFormRef",ref:O,rules:M,"label-position":"top"},{default:i((()=>[n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"国家：",prop:"country_ids",required:""},{default:i((()=>[n(h,{placeholder:"请选择",modelValue:$.value.country_ids,"onUpdate:modelValue":a[4]||(a[4]=e=>$.value.country_ids=e),size:"large",multiple:"",onChange:P},{default:i((()=>[(r(!0),d(_,null,c(m(j).basicData.countryList,((e,a)=>(r(),s(f,{label:e.name,value:e.id,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(v,{span:12},{default:i((()=>[n(u,{label:"代收货币：",prop:"coin_ids",required:""},{default:i((()=>[n(h,{size:"large",placeholder:"请选择",multiple:"",modelValue:$.value.coin_ids,"onUpdate:modelValue":a[5]||(a[5]=e=>$.value.coin_ids=e)},{default:i((()=>[(r(!0),d(_,null,c(R.value,((e,a)=>(r(),s(f,{label:e.name,value:e.id,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"代收支付方式：",prop:"pay_way_id",required:""},{default:i((()=>[n(h,{size:"large",placeholder:"请选择",modelValue:$.value.pay_way_id,"onUpdate:modelValue":a[6]||(a[6]=e=>$.value.pay_way_id=e)},{default:i((()=>[(r(!0),d(_,null,c(m(j).basicData.options.pay_way,((e,a)=>(r(),s(f,{label:e.value,value:e.id,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(v,{span:12},{default:i((()=>[n(u,{label:"结算周期：",prop:"billing_id",required:""},{default:i((()=>[n(h,{size:"large",placeholder:"请选择",modelValue:$.value.billing_id,"onUpdate:modelValue":a[7]||(a[7]=e=>$.value.billing_id=e)},{default:i((()=>[(r(!0),d(_,null,c(m(j).basicData.options.billing,((e,a)=>(r(),s(f,{label:e.value,value:e.id,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"是否支持提U",prop:"is_u",required:""},{default:i((()=>[n(E,{modelValue:$.value.is_u,"onUpdate:modelValue":a[8]||(a[8]=e=>$.value.is_u=e),class:"ml-4"},{default:i((()=>[n(C,{label:1,size:"large"},{default:i((()=>[p("是")])),_:1}),n(C,{label:0,size:"large"},{default:i((()=>[p("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(v,{span:12},{default:i((()=>[n(u,{label:"通道费率：",prop:"pay_rate",required:""},{default:i((()=>[n(t,{modelValue:$.value.pay_rate,"onUpdate:modelValue":a[9]||(a[9]=e=>$.value.pay_rate=e),size:"large",placeholder:"请输入"},{append:i((()=>[p("%")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])):2===T.value?(r(),s(y,{key:2,model:$.value,ref_key:"ruleFormRef",ref:O,rules:M,"label-position":"top"},{default:i((()=>[n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"保证金：",prop:"margin_balance",required:""},{default:i((()=>[n(t,{size:"large",modelValue:$.value.margin_balance,"onUpdate:modelValue":a[10]||(a[10]=e=>$.value.margin_balance=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(b,{gutter:18},{default:i((()=>[n(v,{span:12},{default:i((()=>[n(u,{label:"余额：",prop:"balance",required:""},{default:i((()=>[n(t,{size:"large",modelValue:$.value.balance,"onUpdate:modelValue":a[11]||(a[11]=e=>$.value.balance=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])):g("",!0)])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-3aec5e3f"]]),Q={class:"search-data"},W=(e=>($("data-v-d8dc04c8"),e=e(),L(),e))((()=>o("div",{class:"search-result"},"通道信息",-1))),A=C(e({__name:"SearchTable",setup(e){const a=v("emitter"),u=t({data:{}}),s=l(),c=t({data:{}});D((()=>{m(),a.on("refreshTable",m)})),E((()=>{a.off("refreshTable")}));const m=(e=1)=>{j(e).then((e=>{u.data=e.data}))};return(e,a)=>{const l=I,t=P,g=x,v=R;return r(),d(_,null,[o("div",Q,[W,n(v,{table:u.data,onCurrentChange:m},{default:i((()=>[n(l,{prop:"id",label:"序号",width:"80"},{default:i((e=>[p(F(e.$index+1),1)])),_:1}),n(l,{prop:"channel_name",label:"通道名称",width:"200"}),n(l,{prop:"channel_num",label:"通道号",width:"200"}),n(l,{prop:"product_type_id_text",label:"支持产品类型",width:"140"}),n(l,{prop:"coin_ids_text",label:"代收货币",width:"220"}),n(l,{prop:"pay_way_id_text",label:"代收支付方式",width:"200"}),n(l,{prop:"country_ids_text",label:"国家",width:"200"}),n(l,{prop:"is_u",label:"是否支持提U",width:"120"},{default:i((e=>[p(F(e.row.is_u?"是":"否"),1)])),_:1}),n(l,{prop:"pay_rate",label:"通道费率 (%)",width:"140"}),n(l,{prop:"billing_id_text",label:"结算周期",width:"120"}),n(l,{prop:"status",label:"通道状态",width:"120"},{default:i((e=>[n(t,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":0,onChange:a=>(({id:e,status:a})=>{T({id:e,status:a}).then((e=>{1===e.code&&y({title:"通知",message:"更改状态成功",type:"success",showClose:!1,duration:3e3})}))})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),n(l,{prop:"margin_balance",label:"保证金金额",width:"120"}),n(l,{prop:"created",label:"创建时间",width:"200"}),n(l,{fixed:"right",label:"操作",width:"120"},{default:i((e=>[n(g,{link:"",type:"primary",size:"small",onClick:a=>{return l=e.row,s.value.dialogFormVisible=!0,void(c.data=l);var l}},{default:i((()=>[p(" 修改 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["table"])]),n(N,{ref_key:"channelEntryDialog",ref:s,"channel-data":c},null,8,["channel-data"])],64)}}}),[["__scopeId","data-v-d8dc04c8"]]),X={class:"search-container"},Y={class:"header"},Z=C(e({__name:"index",setup(e){const a=l();return(e,l)=>{const t=M("Plus"),u=O,s=x;return r(),d(_,null,[o("div",X,[o("div",Y,[n(s,{type:"primary",onClick:l[0]||(l[0]=e=>a.value.dialogFormVisible=!0)},{default:i((()=>[n(u,null,{default:i((()=>[n(t)])),_:1}),p(" 通道录入 ")])),_:1})]),n(A)]),n(N,{ref_key:"channelEntryDialog",ref:a},null,512)],64)}}}),[["__scopeId","data-v-d674b30c"]]);export{Z as default};
