import{b as e,d as t,e as o,f as a}from"./index-c87fca7b.js";import{E as l,b as u}from"./element-plus-28874c90.js";import{_ as r}from"./index-f34b3952.js";import"./@vueuse-adc9bbdc.js";import"./@vue-3c868319.js";import"./@element-plus-5ebee6a8.js";import"./@ctrl-91de2ec7.js";import"./lodash-es-4fe5ddc0.js";import"./vue-router-92c379a0.js";import"./pinia-9ce07316.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./axios-fb7d3bb8.js";import"./zipson-6762d745.js";import"./clipboard-cbe03109.js";import"./mitt-f0e54764.js";const n={class:"dialog-footer"},s=r(Vue.defineComponent({__name:"RegistrationDialog",setup(t,{expose:o}){const a=Vue.inject("emitter"),u=Vue.ref(!1),r=Vue.ref();Vue.watch(u,((e,t)=>{e&&(r.value={username:"",password:"",role:1})}));const s=Vue.reactive({username:[{required:!0,message:"请输入商户账号：",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(e,t,o)=>{t?/^.{6,}$/.test(t)?o():o(new Error("请输入密码，最少6位")):o(new Error("请输入密码"))},trigger:"blur"}]}),V=Vue.ref();return o({dialogFormVisible:u}),(t,o)=>{const d=Vue.resolveComponent("el-input"),i=Vue.resolveComponent("el-form-item"),c=Vue.resolveComponent("el-col"),p=Vue.resolveComponent("el-row"),m=Vue.resolveComponent("el-option"),h=Vue.resolveComponent("el-select"),f=Vue.resolveComponent("el-form"),v=Vue.resolveComponent("el-button"),C=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(C,{modelValue:u.value,"onUpdate:modelValue":o[4]||(o[4]=e=>u.value=e),title:"添加账号",class:"sub-dialog",closeOnClickModal:!1,width:"756px","destroy-on-close":!0},{footer:Vue.withCtx((()=>[Vue.createElementVNode("span",n,[Vue.createVNode(v,{type:"primary",onClick:o[3]||(o[3]=t=>(async t=>{t&&await t.validate(((t,o)=>{t&&e(r.value).then((e=>{1===e.code&&(l({title:"通知",message:"添加成功",type:"success",showClose:!1,duration:3e3}),u.value=!1,a.emit("refreshTable"))}))}))})(V.value))},{default:Vue.withCtx((()=>[Vue.createTextVNode("生成账号")])),_:1})])])),default:Vue.withCtx((()=>[Vue.createVNode(f,{model:r.value,ref_key:"ruleFormRef",ref:V,rules:s,"label-position":"top"},{default:Vue.withCtx((()=>[Vue.createVNode(p,{gutter:18},{default:Vue.withCtx((()=>[Vue.createVNode(c,{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(i,{label:"商户账号：",prop:"username",required:""},{default:Vue.withCtx((()=>[Vue.createVNode(d,{modelValue:r.value.username,"onUpdate:modelValue":o[0]||(o[0]=e=>r.value.username=e),size:"large",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),Vue.createVNode(p,{gutter:18},{default:Vue.withCtx((()=>[Vue.createVNode(c,{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(i,{label:"密码：",prop:"password",required:""},{default:Vue.withCtx((()=>[Vue.createVNode(d,{size:"large",modelValue:r.value.password,"onUpdate:modelValue":o[1]||(o[1]=e=>r.value.password=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),Vue.createVNode(p,{gutter:18},{default:Vue.withCtx((()=>[Vue.createVNode(c,{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(i,{label:"商户类型：",prop:"role",required:""},{default:Vue.withCtx((()=>[Vue.createVNode(h,{size:"large",placeholder:"请选择",modelValue:r.value.role,"onUpdate:modelValue":o[2]||(o[2]=e=>r.value.role=e)},{default:Vue.withCtx((()=>[Vue.createVNode(m,{label:"普通商户",value:1}),Vue.createVNode(m,{label:"代理商",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-57e70580"]]),V={class:"search-data"},d=(e=>(Vue.pushScopeId("data-v-3ccfa806"),e=e(),Vue.popScopeId(),e))((()=>Vue.createElementVNode("div",{class:"search-result"},"商户信息",-1))),i=r(Vue.defineComponent({__name:"SearchTable",setup(e){const r=Vue.inject("emitter"),n=Vue.reactive({data:{}}),i=Vue.ref(),c=Vue.reactive({data:{}});Vue.onMounted((()=>{p(),r.on("refreshTable",p)})),Vue.onBeforeUnmount((()=>{r.off("refreshTable")}));const p=(e=1,o=10)=>{t({page:e,rows:o}).then((e=>{n.data=e.data}))};return(e,t)=>{const r=Vue.resolveComponent("el-table-column"),m=Vue.resolveComponent("el-switch"),h=Vue.resolveComponent("el-button"),f=Vue.resolveComponent("common-table");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",V,[d,Vue.createVNode(f,{table:n.data,onCurrentChange:p},{default:Vue.withCtx((()=>[Vue.createVNode(r,{prop:"username",label:"商户账号"}),Vue.createVNode(r,{prop:"nickname",label:"商户名称"}),Vue.createVNode(r,{prop:"product_type_ids_text",label:"商户类型"},{default:Vue.withCtx((e=>[Vue.createTextVNode(Vue.toDisplayString(1===e.row.role?"普通商户":"代理商"),1)])),_:1}),Vue.createVNode(r,{prop:"status",label:"账号状态",width:"120"},{default:Vue.withCtx((e=>[Vue.createVNode(m,{modelValue:e.row.mch_status,"onUpdate:modelValue":t=>e.row.mch_status=t,"active-value":1,"inactive-value":0,onChange:t=>(({id:e,mch_status:t})=>{o({user_id:e,mch_status:t}).then((e=>{1===e.code&&l({title:"通知",message:"更改状态成功",type:"success",showClose:!1,duration:3e3})}))})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),Vue.createVNode(r,{prop:"createtime",label:"创建时间","min-width":"160"}),Vue.createVNode(r,{prop:"updatetime",label:"最新修改时间","min-width":"160"}),Vue.createVNode(r,{fixed:"right",label:"操作",width:"150"},{default:Vue.withCtx((e=>[Vue.createVNode(h,{link:"",type:"primary",size:"small",onClick:t=>(({id:e})=>{u.prompt("请输入密码","修改密码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{6,}$/,inputErrorMessage:"密码不能少于6位",closeOnClickModal:!1}).then((({value:t})=>{a({user_id:e,password:t}).then((e=>{1===e.code&&l({title:"通知",message:"修改成功",type:"success",showClose:!1,duration:3e3})}))})).catch((()=>{}))})(e.row)},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 修改密码 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["table"])]),Vue.createVNode(s,{ref_key:"registrationDialog",ref:i,channelData:c},null,8,["channelData"])],64)}}}),[["__scopeId","data-v-3ccfa806"]]),c={class:"search-container"},p={class:"header"},m=r(Vue.defineComponent({__name:"index",setup(e){const t=Vue.ref();return(e,o)=>{const a=Vue.resolveComponent("Plus"),l=Vue.resolveComponent("el-icon"),u=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",c,[Vue.createElementVNode("div",p,[Vue.createVNode(u,{type:"primary",onClick:o[0]||(o[0]=e=>t.value.dialogFormVisible=!0)},{default:Vue.withCtx((()=>[Vue.createVNode(l,null,{default:Vue.withCtx((()=>[Vue.createVNode(a)])),_:1}),Vue.createTextVNode(" 添加账号 ")])),_:1})]),Vue.createVNode(i)]),Vue.createVNode(s,{ref_key:"registrationDialog",ref:t},null,512)],64)}}}),[["__scopeId","data-v-0b04b2ba"]]);export{m as default};
