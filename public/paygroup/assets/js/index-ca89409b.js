import{E as e,h as a,i as l,y as s,A as t,F as r,G as o,j as u,k as i,d,b as n,B as p,J as m,e as c}from"./element-plus-7c00a5ec.js";import{_ as f,d as _}from"./index-61c15573.js";import{b as h,d as v,e as g,f as b}from"./index-e085eb87.js";import{F as j,e as w,f as y,K as V,o as k,c as C,P as x,S as z,a as T,W as U,A as q,i as D,z as F,X as E,Q as B,au as I,av as M,ah as P}from"./@vue-83238ad5.js";import"./lodash-es-6861d6dc.js";import"./async-validator-cf877c1f.js";import"./@vueuse-974038d5.js";import"./dayjs-6442e2b1.js";import"./clipboard-690b0fc8.js";import"./@element-plus-9fff3ffd.js";import"./@ctrl-91de2ec7.js";import"./@popperjs-b78c3215.js";import"./escape-html-3c2115ff.js";import"./normalize-wheel-es-3222b0a2.js";import"./vue-router-62c38a24.js";import"./axios-a8ee11a1.js";import"./pinia-34541c90.js";import"./pinia-plugin-persistedstate-d2bd58cf.js";import"./zipson-d6101bf1.js";import"./mitt-f0e54764.js";const A={class:"dialog-footer"},O=f(j({__name:"RegistrationDialog",setup(n,{expose:p}){const m=q("emitter"),c=w(!1),f=w();y(c,((e,a)=>{e&&(f.value={username:"",password:"",role:1})}));const _=V({username:[{required:!0,message:"请输入商户账号：",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(e,a,l)=>{a?/^.{6,}$/.test(a)?l():l(new Error("请输入密码，最少6位")):l(new Error("请输入密码"))},trigger:"blur"}]}),v=w();return p({dialogFormVisible:c}),(n,p)=>{const g=a,b=l,j=s,w=t,y=r,V=o,q=u,D=i,F=d;return k(),C("div",null,[x(F,{modelValue:c.value,"onUpdate:modelValue":p[4]||(p[4]=e=>c.value=e),title:"添加账号",class:"sub-dialog",closeOnClickModal:!1,width:"756px","destroy-on-close":!0},{footer:z((()=>[T("span",A,[x(D,{type:"primary",onClick:p[3]||(p[3]=a=>(async a=>{a&&await a.validate(((a,l)=>{a&&h(f.value).then((a=>{1===a.code&&(e({title:"通知",message:"添加成功",type:"success",showClose:!1,duration:3e3}),c.value=!1,m.emit("refreshTable"))}))}))})(v.value))},{default:z((()=>[U("生成账号")])),_:1})])])),default:z((()=>[x(q,{model:f.value,ref_key:"ruleFormRef",ref:v,rules:_,"label-position":"top"},{default:z((()=>[x(w,{gutter:18},{default:z((()=>[x(j,{span:12},{default:z((()=>[x(b,{label:"商户账号：",prop:"username",required:""},{default:z((()=>[x(g,{modelValue:f.value.username,"onUpdate:modelValue":p[0]||(p[0]=e=>f.value.username=e),size:"large",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),x(w,{gutter:18},{default:z((()=>[x(j,{span:12},{default:z((()=>[x(b,{label:"密码：",prop:"password",required:""},{default:z((()=>[x(g,{size:"large",modelValue:f.value.password,"onUpdate:modelValue":p[1]||(p[1]=e=>f.value.password=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),x(w,{gutter:18},{default:z((()=>[x(j,{span:12},{default:z((()=>[x(b,{label:"商户类型：",prop:"role",required:""},{default:z((()=>[x(V,{size:"large",placeholder:"请选择",modelValue:f.value.role,"onUpdate:modelValue":p[2]||(p[2]=e=>f.value.role=e)},{default:z((()=>[x(y,{label:"普通商户",value:1}),x(y,{label:"代理商",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-57e70580"]]),R={class:"search-data"},S=(e=>(I("data-v-3ccfa806"),e=e(),M(),e))((()=>T("div",{class:"search-result"},"商户信息",-1))),$=f(j({__name:"SearchTable",setup(a){const l=q("emitter"),s=V({data:{}}),t=w(),r=V({data:{}});D((()=>{o(),l.on("refreshTable",o)})),F((()=>{l.off("refreshTable")}));const o=(e=1,a=10)=>{v({page:e,rows:a}).then((e=>{s.data=e.data}))};return(a,l)=>{const u=p,d=m,c=i,f=_;return k(),C(B,null,[T("div",R,[S,x(f,{table:s.data,onCurrentChange:o},{default:z((()=>[x(u,{prop:"username",label:"商户账号"}),x(u,{prop:"nickname",label:"商户名称"}),x(u,{prop:"product_type_ids_text",label:"商户类型"},{default:z((e=>[U(E(1===e.row.role?"普通商户":"代理商"),1)])),_:1}),x(u,{prop:"status",label:"账号状态",width:"120"},{default:z((a=>[x(d,{modelValue:a.row.mch_status,"onUpdate:modelValue":e=>a.row.mch_status=e,"active-value":1,"inactive-value":0,onChange:l=>(({id:a,mch_status:l})=>{g({user_id:a,mch_status:l}).then((a=>{1===a.code&&e({title:"通知",message:"更改状态成功",type:"success",showClose:!1,duration:3e3})}))})(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),x(u,{prop:"createtime",label:"创建时间","min-width":"160"}),x(u,{prop:"updatetime",label:"最新修改时间","min-width":"160"}),x(u,{fixed:"right",label:"操作",width:"150"},{default:z((a=>[x(c,{link:"",type:"primary",size:"small",onClick:l=>(({id:a})=>{n.prompt("请输入密码","修改密码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{6,}$/,inputErrorMessage:"密码不能少于6位",closeOnClickModal:!1}).then((({value:l})=>{b({user_id:a,password:l}).then((a=>{1===a.code&&e({title:"通知",message:"修改成功",type:"success",showClose:!1,duration:3e3})}))})).catch((()=>{}))})(a.row)},{default:z((()=>[U(" 修改密码 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["table"])]),x(O,{ref_key:"registrationDialog",ref:t,channelData:r},null,8,["channelData"])],64)}}}),[["__scopeId","data-v-3ccfa806"]]),G={class:"search-container"},H={class:"header"},J=f(j({__name:"index",setup(e){const a=w();return(e,l)=>{const s=P("Plus"),t=c,r=i;return k(),C(B,null,[T("div",G,[T("div",H,[x(r,{type:"primary",onClick:l[0]||(l[0]=e=>a.value.dialogFormVisible=!0)},{default:z((()=>[x(t,null,{default:z((()=>[x(s)])),_:1}),U(" 添加账号 ")])),_:1})]),x($)]),x(O,{ref_key:"registrationDialog",ref:a},null,512)],64)}}}),[["__scopeId","data-v-0b04b2ba"]]);export{J as default};
